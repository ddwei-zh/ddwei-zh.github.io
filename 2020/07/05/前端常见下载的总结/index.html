<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
        <title>前端常见下载方法的总结 | 前端漫漫路</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel='shortcut icon' href="/favicon.ico">
    
<link rel="stylesheet" href="/css/index.css">

    
<link rel="stylesheet" href="/css/plugins/highlight/dark.css">

    
<link rel="stylesheet" href="/css/plugins/iconfont/iconfont.css">

<meta name="generator" content="Hexo 4.2.1"></head>
<body>
    <div class="navbar-container">
    <div class="navbar">
        <ul>
            <li><a href="/">前端漫漫路</a></li>
            <li><a href="/">首页</a></li>
            <li><a href='/categories'>CATEGORIES</a></li>
            <li><a href="/tags">TAGS</a></li>
            <li><a href="/about">ABOUT</a></li>
        </ul>
    </div>
</div>
    <div class="all-container">
        <div class="article-container">
    <h2 class="title">前端常见下载方法的总结</h2>
    <span class="info">2020年7月5日</span>
    
    
        <div class="toc">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#接口是下载文件的路径"><span class="toc-number">1.</span> <span class="toc-text">接口是下载文件的路径</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用blob下载二进制流"><span class="toc-number">2.</span> <span class="toc-text">使用blob下载二进制流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大文件下载"><span class="toc-number">3.</span> <span class="toc-text">大文件下载</span></a></li></ol>
        </div>
    

    <div class="content"><ul>
<li><a href="https://juejin.im/post/5d254a846fb9a07efd47337e" target="_blank" rel="noopener">常用的下载方式</a><h2 id="接口是下载文件的路径"><a href="#接口是下载文件的路径" class="headerlink" title="接口是下载文件的路径"></a>接口是下载文件的路径</h2></li>
</ul>
<ol>
<li><code>window</code></li>
<li><code>location</code></li>
<li><code>a</code></li>
<li><code>iframe</code></li>
<li><code>form的action触发</code><h2 id="使用blob下载二进制流"><a href="#使用blob下载二进制流" class="headerlink" title="使用blob下载二进制流"></a><code>使用blob下载二进制流</code></h2></li>
</ol>
<ul>
<li>先请求数据下载</li>
</ul>
<ul>
<li>fetch</li>
<li>XMLhTTP<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">netDiskMaterialFileDownload(filePath,fileName,startFn,endFn,errorFn) &#123;</span><br><span class="line">    startFn()</span><br><span class="line">    axios(&#123;</span><br><span class="line">      url: filePath,</span><br><span class="line">      method: &#39;get&#39;,</span><br><span class="line">      responseType: &#39;blob&#39;</span><br><span class="line">    &#125;).then( res &#x3D;&gt; &#123;</span><br><span class="line">       endFn()</span><br><span class="line">       let blob &#x3D; new Blob([res.data], &#123;</span><br><span class="line">        type: &#39;application&#x2F;octet-stream&#39;  &#x2F;&#x2F; 下载的文件类型格式（二进制流，不知道下载文件类型可以设置为这个）, 具体请查看HTTP Content-type 对照表</span><br><span class="line">      &#125;)</span><br><span class="line">      if (window.navigator &amp;&amp; window.navigator.msSaveOrOpenBlob) &#123;  &#x2F;&#x2F; IE下对blob的兼容处理</span><br><span class="line">        window.navigator.msSaveOrOpenBlob(blob, fileName);</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      let url &#x3D; URL.createObjectURL(blob)</span><br><span class="line">      let a &#x3D; document.createElement(&#39;a&#39;)</span><br><span class="line">      a.style.display &#x3D; &#39;none&#39;</span><br><span class="line">      a.href &#x3D; url</span><br><span class="line">      a.setAttribute(&#39;download&#39;, fileName)   &#x2F;&#x2F; 设置下载的文件名</span><br><span class="line">      document.body.appendChild(a) </span><br><span class="line">      a.click()</span><br><span class="line">      document.body.removeChild(a)       &#x2F;&#x2F;下载完成移除dom元素</span><br><span class="line">      URL.revokeObjectURL(url)  &#x2F;&#x2F;释放blob对象</span><br><span class="line">    &#125;).catch(err &#x3D;&gt; &#123;</span><br><span class="line">      endFn()</span><br><span class="line">      errorFn(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="大文件下载"><a href="#大文件下载" class="headerlink" title="大文件下载"></a><code>大文件下载</code></h2></li>
</ul>
<ul>
<li><code>请求超时问题</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">临时通过改变axios的超时时间解决</span><br><span class="line">  禁止先请求数据然后下载的方式</span><br><span class="line">  应该服务设置Content-Type: attachment;filename&#x3D;xxx (附件) &#x2F; inline;filename&#x3D;xxx (内连)</span><br><span class="line">  默认是直接打开</span><br></pre></td></tr></table></figure>

</li>
</ul>
</div>
    <hr>
    <div class="tags"></div>
</div>
<div class="paging">
    
    
        <a id="prev" href="/2020/07/05/%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83/">PREV_PAGE</a>
    
    
        <a id="next" href="/2020/07/05/git%E4%BD%BF%E7%94%A8/">NEXT_PAGE</a>
    
</div>
<div class="footer">
    <p><a href="/about/">Please Contact the Author before Reproduce.</a></p>
</div>

<script src="/js/highlight.pack.js"></script>

</script>
<script>
	hljs.initHighlightingOnLoad();
</script>

<script src="/js/iconfont.js"></script>

<style>
    .icon {
      width: 1rem;
      height: 1rem;
      vertical-align: -0.15em;
      fill: currentColor;
      overflow: hidden;
    }
</style>
    
    </div>
    <div class='rights'>
	<p>©<span id='years'></span> Mint Forge. All Rights Reserved.</p>
</div>
<script type="text/javascript">
	var today = new Date()
	var years = today.getFullYear()
	document.getElementById('years').innerHTML=years
</script>
    
<script src="/js/iconfont.js"></script>

<style>
    .icon {
      width: 1rem;
      height: 1rem;
      vertical-align: -0.15em;
      fill: currentColor;
      overflow: hidden;
    }
</style>
    
</body>
</html>